version = "2.0"

[sink_group]
name = "nginx_jnginx"
rule = ["/nginx/flb_nginx"]

# file
[[sink_group.sinks]]
connect = "file_json_sink"
name = "file-1"
params = { file = "file-1.dat" }

# Kafka
[[sink_group.sinks]]
connect = "kafka_sink"
name = "kafka-1"
params= { topic = "wp.output.jnginx" ,brokers = "localhost:9092" }

# vlog
[[sink_group.sinks]]
name = "vlog-1"
connect = "victorialogs_sink"
params = { endpoint = "http://localhost:9428", insert_path = "/insert/jsonline", flush_interval_secs = 3}

# doris
[[sink_group.sinks]]
name = "doris-1"
connect = "doris_sink"
[sink_group.sinks.params]
endpoint="mysql://localhost:9030/?charset=utf8mb4&connect_timeout=10"
user = "root"
password = ""
database="test_db"
table = "wp_jnginx"

[sink_group.sinks.expect]
ratio = 0.50
tol   = 0.02

# # ===========2===============
# Kafka
[[sink_group.sinks]]
connect = "kafka_sink"
name = "kafka-2"
params= { topic = "wp.output.all" ,brokers = "127.0.0.1:9093" }

# file
[[sink_group.sinks]]
connect = "file_json_sink"
name = "file-2"
params = { file = "file-2.dat" }

# vlog
[[sink_group.sinks]]
name = "vlog-2"
connect = "victorialogs_sink"
params = { endpoint = "http://localhost:9429", insert_path = "/insert/jsonline", flush_interval_secs = 3}

# doris
[[sink_group.sinks]]
name = "doris-2"
connect = "doris_sink"
[sink_group.sinks.params]
endpoint="mysql://localhost:9031/?charset=utf8mb4&connect_timeout=10"
user = "root"
password = ""
database="test_db"
table = "wp_jnginx"